var Utilities,PermitSearch;(function(n,t){typeof exports=="object"&&typeof module!="undefined"?t():typeof define=="function"&&define.amd?define(t):t()})(this,function(){"use strict";function f(n){var t=this.constructor;return this.then(function(i){return t.resolve(n()).then(function(){return i})},function(i){return t.resolve(n()).then(function(){return t.reject(i)})})}function h(){}function c(n,t){return function(){n.apply(t,arguments)}}function n(t){if(!(this instanceof n))throw new TypeError("Promises must be constructed via new");if(typeof t!="function")throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=undefined;this._deferreds=[];o(t,this)}function e(i,u){while(i._state===3)i=i._value;if(i._state===0){i._deferreds.push(u);return}i._handled=!0;n._immediateFn(function(){var n=i._state===1?u.onFulfilled:u.onRejected,f;if(n===null){(i._state===1?r:t)(u.promise,i._value);return}try{f=n(i._value)}catch(e){t(u.promise,e);return}r(u.promise,f)})}function r(i,r){try{if(r===i)throw new TypeError("A promise cannot be resolved with itself.");if(r&&(typeof r=="object"||typeof r=="function")){var f=r.then;if(r instanceof n){i._state=3;i._value=r;u(i);return}if(typeof f=="function"){o(c(f,r),i);return}}i._state=1;i._value=r;u(i)}catch(e){t(i,e)}}function t(n,t){n._state=2;n._value=t;u(n)}function u(t){t._state===2&&t._deferreds.length===0&&n._immediateFn(function(){t._handled||n._unhandledRejectionFn(t._value)});for(var i=0,r=t._deferreds.length;i<r;i++)e(t,t._deferreds[i]);t._deferreds=null}function l(n,t,i){this.onFulfilled=typeof n=="function"?n:null;this.onRejected=typeof t=="function"?t:null;this.promise=i}function o(n,i){var u=!1;try{n(function(n){u||(u=!0,r(i,n))},function(n){u||(u=!0,t(i,n))})}catch(f){if(u)return;u=!0;t(i,f)}}var s=setTimeout,i;n.prototype["catch"]=function(n){return this.then(null,n)};n.prototype.then=function(n,t){var i=new this.constructor(h);return e(this,new l(n,t,i)),i};n.prototype["finally"]=f;n.all=function(t){return new n(function(n,i){function e(t,u){try{if(u&&(typeof u=="object"||typeof u=="function")){var o=u.then;if(typeof o=="function"){o.call(u,function(n){e(t,n)},i);return}}r[t]=u;--f==0&&n(r)}catch(s){i(s)}}var r,f,u;if(!t||typeof t.length=="undefined")throw new TypeError("Promise.all accepts an array");if(r=Array.prototype.slice.call(t),r.length===0)return n([]);for(f=r.length,u=0;u<r.length;u++)e(u,r[u])})};n.resolve=function(t){return t&&typeof t=="object"&&t.constructor===n?t:new n(function(n){n(t)})};n.reject=function(t){return new n(function(n,i){i(t)})};n.race=function(t){return new n(function(n,i){for(var r=0,u=t.length;r<u;r++)t[r].then(n,i)})};n._immediateFn=typeof setImmediate=="function"&&function(n){setImmediate(n)}||function(n){s(n,0)};n._unhandledRejectionFn=function(n){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",n)};i=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("unable to locate global object");}();"Promise"in i?i.Promise.prototype["finally"]||(i.Promise.prototype["finally"]=f):i.Promise=n}),function(n){"use strict";function f(n){if(typeof n!="string"&&(n=String(n)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(n))throw new TypeError("Invalid character in header field name");return n.toLowerCase()}function s(n){return typeof n!="string"&&(n=String(n)),n}function e(n){var t={next:function(){var t=n.shift();return{done:t===undefined,value:t}}};return i.iterable&&(t[Symbol.iterator]=function(){return t}),t}function t(n){this.map={};n instanceof t?n.forEach(function(n,t){this.append(t,n)},this):Array.isArray(n)?n.forEach(function(n){this.append(n[0],n[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(t){this.append(t,n[t])},this)}function o(n){if(n.bodyUsed)return Promise.reject(new TypeError("Already read"));n.bodyUsed=!0}function h(n){return new Promise(function(t,i){n.onload=function(){t(n.result)};n.onerror=function(){i(n.error)}})}function b(n){var t=new FileReader,i=h(t);return t.readAsArrayBuffer(n),i}function k(n){var t=new FileReader,i=h(t);return t.readAsText(n),i}function d(n){for(var i=new Uint8Array(n),r=new Array(i.length),t=0;t<i.length;t++)r[t]=String.fromCharCode(i[t]);return r.join("")}function c(n){if(n.slice)return n.slice(0);var t=new Uint8Array(n.byteLength);return t.set(new Uint8Array(n)),t.buffer}function l(){return this.bodyUsed=!1,this._initBody=function(n){if(this._bodyInit=n,n)if(typeof n=="string")this._bodyText=n;else if(i.blob&&Blob.prototype.isPrototypeOf(n))this._bodyBlob=n;else if(i.formData&&FormData.prototype.isPrototypeOf(n))this._bodyFormData=n;else if(i.searchParams&&URLSearchParams.prototype.isPrototypeOf(n))this._bodyText=n.toString();else if(i.arrayBuffer&&i.blob&&p(n))this._bodyArrayBuffer=c(n.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else if(i.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(n)||w(n)))this._bodyArrayBuffer=c(n);else throw new Error("unsupported BodyInit type");else this._bodyText="";this.headers.get("content-type")||(typeof n=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i.searchParams&&URLSearchParams.prototype.isPrototypeOf(n)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i.blob&&(this.blob=function(){var n=o(this);if(n)return n;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");else return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(b)}),this.text=function(){var n=o(this);if(n)return n;if(this._bodyBlob)return k(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(d(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");else return Promise.resolve(this._bodyText)},i.formData&&(this.formData=function(){return this.text().then(nt)}),this.json=function(){return this.text().then(JSON.parse)},this}function g(n){var t=n.toUpperCase();return a.indexOf(t)>-1?t:n}function u(n,i){i=i||{};var r=i.body;if(n instanceof u){if(n.bodyUsed)throw new TypeError("Already read");this.url=n.url;this.credentials=n.credentials;i.headers||(this.headers=new t(n.headers));this.method=n.method;this.mode=n.mode;r||n._bodyInit==null||(r=n._bodyInit,n.bodyUsed=!0)}else this.url=String(n);if(this.credentials=i.credentials||this.credentials||"omit",(i.headers||!this.headers)&&(this.headers=new t(i.headers)),this.method=g(i.method||this.method||"GET"),this.mode=i.mode||this.mode||null,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function nt(n){var t=new FormData;return n.trim().split("&").forEach(function(n){if(n){var i=n.split("="),r=i.shift().replace(/\+/g," "),u=i.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(u))}}),t}function tt(n){var i=new t,r=n.replace(/\r?\n[\t ]+/g," ");return r.split(/\r?\n/).forEach(function(n){var t=n.split(":"),r=t.shift().trim(),u;r&&(u=t.join(":").trim(),i.append(r,u))}),i}function r(n,i){i||(i={});this.type="default";this.status=i.status===undefined?200:i.status;this.ok=this.status>=200&&this.status<300;this.statusText="statusText"in i?i.statusText:"OK";this.headers=new t(i.headers);this.url=i.url||"";this._initBody(n)}var i,a,v;if(!n.fetch){if(i={searchParams:"URLSearchParams"in n,iterable:"Symbol"in n&&"iterator"in Symbol,blob:"FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch(n){return!1}}(),formData:"FormData"in n,arrayBuffer:"ArrayBuffer"in n},i.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],p=function(n){return n&&DataView.prototype.isPrototypeOf(n)},w=ArrayBuffer.isView||function(n){return n&&y.indexOf(Object.prototype.toString.call(n))>-1};t.prototype.append=function(n,t){n=f(n);t=s(t);var i=this.map[n];this.map[n]=i?i+","+t:t};t.prototype["delete"]=function(n){delete this.map[f(n)]};t.prototype.get=function(n){return n=f(n),this.has(n)?this.map[n]:null};t.prototype.has=function(n){return this.map.hasOwnProperty(f(n))};t.prototype.set=function(n,t){this.map[f(n)]=s(t)};t.prototype.forEach=function(n,t){for(var i in this.map)this.map.hasOwnProperty(i)&&n.call(t,this.map[i],i,this)};t.prototype.keys=function(){var n=[];return this.forEach(function(t,i){n.push(i)}),e(n)};t.prototype.values=function(){var n=[];return this.forEach(function(t){n.push(t)}),e(n)};t.prototype.entries=function(){var n=[];return this.forEach(function(t,i){n.push([i,t])}),e(n)};i.iterable&&(t.prototype[Symbol.iterator]=t.prototype.entries);a=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];u.prototype.clone=function(){return new u(this,{body:this._bodyInit})};l.call(u.prototype);l.call(r.prototype);r.prototype.clone=function(){return new r(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new t(this.headers),url:this.url})};r.error=function(){var n=new r(null,{status:0,statusText:""});return n.type="error",n};v=[301,302,303,307,308];r.redirect=function(n,t){if(v.indexOf(t)===-1)throw new RangeError("Invalid status code");return new r(null,{status:t,headers:{location:n}})};n.Headers=t;n.Request=u;n.Response=r;n.fetch=function(n,t){return new Promise(function(f,e){var s=new u(n,t),o=new XMLHttpRequest;o.onload=function(){var n={status:o.status,statusText:o.statusText,headers:tt(o.getAllResponseHeaders()||"")},t;n.url="responseURL"in o?o.responseURL:n.headers.get("X-Request-URL");t="response"in o?o.response:o.responseText;f(new r(t,n))};o.onerror=function(){e(new TypeError("Network request failed"))};o.ontimeout=function(){e(new TypeError("Network request failed"))};o.open(s.method,s.url,!0);s.credentials==="include"?o.withCredentials=!0:s.credentials==="omit"&&(o.withCredentials=!1);"responseType"in o&&i.blob&&(o.responseType="blob");s.headers.forEach(function(n,t){o.setRequestHeader(t,n)});o.send(typeof s._bodyInit=="undefined"?null:s._bodyInit)})};n.fetch.polyfill=!0}}(typeof self!="undefined"?self:this);String.prototype.padStart||(String.prototype.padStart=function(n,t){return n=n>>0,t=String(typeof t!="undefined"?t:" "),this.length>=n?String(this):(n=n-this.length,n>t.length&&(t+=t.repeat(n/t.length)),t.slice(0,n)+String(this))});String.prototype.repeat||(String.prototype.repeat=function(n){"use strict";var t,i;if(this==null)throw new TypeError("can't convert "+this+" to object");if(t=""+this,n=+n,n!=n&&(n=0),n<0)throw new RangeError("repeat count must be non-negative");if(n==Infinity)throw new RangeError("repeat count must be less than infinity");if(n=Math.floor(n),t.length==0||n==0)return"";if(t.length*n>=268435456)throw new RangeError("repeat count must not overflow maximum string size");for(i=t.length*n,n=Math.floor(Math.log(n)/Math.log(2));n;)t+=t,n--;return t+t.substring(0,i-t.length)}),function(n){function t(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("hide");n.classList.remove("show");n.classList.remove("show-inline");n.classList.remove("show-flex")}function i(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("show");n.classList.remove("hide");n.classList.remove("show-inline");n.classList.remove("show-flex")}function l(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("show-inline");n.classList.remove("hide");n.classList.remove("show");n.classList.remove("show-flex")}function a(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("show-flex");n.classList.remove("hide");n.classList.remove("show-inline");n.classList.remove("show")}function e(n,u,f){var e,o,s;typeof n=="string"&&(n=document.getElementById(n));u&&(r(n),e=document.createElement("div"),e.classList.add("notification"),e.classList.add("is-danger"),o=document.createElement("button"),o.classList.add("delete"),o.onclick=function(){t(n)},e.appendChild(o),Array.isArray(u)?(s=document.createElement("ul"),u.forEach(function(n){var t=document.createElement("li");t.appendChild(document.createTextNode(n));s.appendChild(t)}),e.appendChild(s)):e.appendChild(document.createTextNode(u)),n.appendChild(e));i(n);(f==undefined||f===!0)&&window.setTimeout(function(){t(n)},1e4)}function r(n){if(n!==null&&n!==undefined)while(n.firstChild)n.removeChild(n.firstChild)}function v(n,t,i){i===void 0&&(i=!1);var r=document.createElement("option");return r.value=n,r.text=t,r.selected=i,r}function o(n){return typeof n=="string"&&(n=document.getElementById(n)),n.value}function y(n,t){typeof n=="string"&&(n=document.getElementById(n));n.value=t}function u(n,t){typeof n=="string"&&(n=document.getElementById(n));r(n);n.appendChild(document.createTextNode(t))}function s(n){var u=n.replace("nav-",""),r=document.querySelectorAll("#menuTabs > li > a"),t,i;if(r.length>0)for(t=0;t<r.length;t++)i=r.item(t),i.id===n?i.parentElement.classList.add("is-active"):i.parentElement.classList.remove("is-active");f("#views > section",u)}function p(n,t,i){h(n,"nav-"+i);f(t,i)}function h(n,t){var u=document.querySelectorAll(n),i,r;if(u.length>0)for(i=0;i<u.length;i++)r=u.item(i),r.id===t?r.classList.add("is-active"):r.classList.remove("is-active")}function f(n,r){var e=document.querySelectorAll(n),u,f;if(e.length>0)for(u=0;u<e.length;u++)f=e.item(u),f.id===r?i(f):t(f)}function w(n){return fetch(n,{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-cache",credentials:"include"}).then(function(n){if(!n.ok)throw new Error(n.statusText);return n.json()})}function b(n,t){return fetch(n,{method:"POST",body:JSON.stringify(t),cache:"no-cache",headers:{"Content-Type":"application/json"},credentials:"include"}).then(function(n){if(console.log("Post Response",n),!n.ok)throw new Error(n.statusText);return n.json()})}function k(n){return n.toLocaleString("en-US",{style:"currency",currency:"USD"})}function d(n){return n instanceof Date?n.getFullYear()<1e3?"":n.toLocaleDateString("en-us"):new Date(n).getFullYear()<1e3?"":new Date(n).toLocaleDateString("en-US")}function g(n,t,i){var r,u;return(typeof n=="string"&&(n=document.getElementById(n)),r=n,r.tagName.toLowerCase()==="select"?r.parentElement.classList.remove("is-danger"):r.classList.remove("is-danger"),u=o(r).trim(),u.length==0)?(r.tagName.toLowerCase()==="select"?r.parentElement.classList.add("is-danger"):r.classList.add("is-danger"),e(t,i),r.focus(),r.scrollTo(),""):u}function nt(n,t){typeof n=="string"&&(n=document.getElementById(n));var i=n;i.disabled=t;i.classList.toggle("is-loading",t)}function tt(n){var u=document.createElement("li"),t,i,f,o,r,e,s;if(n.selected&&u.classList.add("is-active"),t=document.createElement("a"),t.id=n.id,t.onclick=function(){c(n)},n.icon.length>0){for(i=document.createElement("span"),i.classList.add("icon"),i.classList.add("is-medium"),f=document.createElement("i"),o=n.icon.split(" "),r=0,e=o;r<e.length;r++)s=e[r],f.classList.add(s);i.appendChild(f);t.appendChild(i)}return t.appendChild(document.createTextNode(n.label)),u.appendChild(t),u}function c(n){u("menuTitle",n.title);u("menuSubTitle",n.subTitle);s(n.id);document.getElementById(n.autofocusId).focus();PermitSearch.selected_tab=n.label}function it(t,i){for(var f,e=document.getElementById(t),r=0,u=i;r<u.length;r++)f=u[r],e.appendChild(n.Create_Menu_Element(f))}function rt(){return(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))!=-1?"Opera":navigator.userAgent.indexOf("Chrome")!=-1?"Chrome":navigator.userAgent.indexOf("Safari")!=-1?"Safari":navigator.userAgent.indexOf("Firefox")!=-1?"Firefox":navigator.userAgent.indexOf("MSIE")!=-1||!!document.DOCUMENT_NODE==!0?"IE":"unknown"}n.Hide=t;n.Show=i;n.Show_Inline=l;n.Show_Flex=a;n.Error_Show=e;n.Clear_Element=r;n.Create_Option=v;n.Get_Value=o;n.Set_Value=y;n.Set_Text=u;n.Show_Menu=s;n.Handle_Tabs=p;n.Activate_Inactivate_Selector=h;n.Show_Hide_Selector=f;n.Get=w;n.Post=b;n.Format_Amount=k;n.Format_Date=d;n.Validate_Text=g;n.Toggle_Loading_Button=nt;n.Create_Menu_Element=tt;n.Update_Menu=c;n.Build_Menu_Elements=it;n.CheckBrowser=rt}(Utilities||(Utilities={})),function(n){"use strict";var t=function(){function n(){}return n}();n.MenuItem=t}(Utilities||(Utilities={})),function(n){"use strict";var t=function(){function t(){}return t.Get=function(t){var i=n.GetPath();Utilities.Get(i+"API/Permit/PrintPermit?permit_number="+t).then(function(t){n.LoadMasterPermit(t)},function(n){console.log("error getting master permit "+t,n)})},t}();n.MasterPermit=t}(PermitSearch||(PermitSearch={})),function(n){"use strict";var t=function(){function t(){}return t.Get=function(t){var i=n.GetPath();Utilities.Get(i+"API/Permit/PrintPermit?permit_number="+t).then(function(t){n.LoadAssocPermit(t)},function(n){console.log("error getting assoc permit "+t,n)})},t}();n.AssociatedPermit=t}(PermitSearch||(PermitSearch={})),function(n){"use strict";var t=function(){function t(){this.permit_number=0;this.base_id=0;this.permit_type="";this.days_since_last_passed_inspection=0;this.address="";this.issue_date=new Date;this.co_date=new Date;this.is_closed=!1;this.close_type="";this.passed_final_inspection=!1;this.outstanding_hold_count=0;this.total_charges=0;this.paid_charges=0;this.document_count=0;this.has_related_permits=!1;this.has_plans=!1;this.contractor_number="";this.contractor_name="";this.company_name="";this.owner_name="";this.parcel_number="";this.pin_complete=""}return t.QueryRelatedPermits=function(t){var i=n.GetPath();Utilities.Get(i+"API/Permit/Related?permitnumber="+t.toString()).then(function(t){console.log("related permits",t);t.length===0?n.CreateMessageRow("relatedPermitsResultsBody",4,"No related permits were found for this permit."):n.CreateResultsTable(t,"relatedPermitsResultsHead","relatedPermitsResultsBody",!0)},function(t){n.CreateMessageRow("relatedPermitsResultsBody",4,"There was an issue retrieving the related permits for this permit.  Please refresh this page to try again.");console.log("error getting permits",t)})},t}();n.Permit=t}(PermitSearch||(PermitSearch={})),function(n){"use strict";var t=function(){function t(){this.item_id=-1;this.permit_number=-1;this.charge_description="";this.narrative="";this.amount=0;this.cashier_id=""}return t.QueryCharges=function(i){t.ResetCharges();var r=n.GetPath();Utilities.Get(r+"API/Permit/Charges?permitnumber="+i.toString()).then(function(i){console.log("charges",i);n.permit_charges=i;i.length===0?n.CreateMessageRow(t.charges_container,4,"No charges were found for this permit."):t.CreateTable(i,t.charges_container)},function(n){console.log("error getting charges",n)})},t.CreateTable=function(n,i){for(var o,u,f=document.createDocumentFragment(),r=0,e=n;r<e.length;r++)o=e[r],f.appendChild(t.CreateRow(o));u=document.getElementById(i);Utilities.Clear_Element(u);u.appendChild(f)},t.CreatePrintableViewTable=function(n,i){for(var o,u,f=document.createDocumentFragment(),r=0,e=n;r<e.length;r++)o=e[r],f.appendChild(t.CreatePrintablePermitRow(o));u=document.getElementById(i);Utilities.Clear_Element(u);u.appendChild(f)},t.ResetCharges=function(){n.permit_charges=[];n.CreateMessageRow(t.charges_container,4,"Loading Charges...")},t.CreateRow=function(n){var i=document.createElement("tr"),r,u,f;return i.appendChild(t.CreateCell(n.charge_description)),r=n.narrative!==n.charge_description?n.narrative:"",i.appendChild(t.CreateCell(r)),i.appendChild(t.CreateCell(Utilities.Format_Amount(n.amount),"has-text-right")),n.cashier_id.length===0?(u="https://public.claycountygov.com/claypay/#permit="+n.permit_number.toString(),i.appendChild(t.CreateCellLink("Pay Now","has-text-centered",u))):(f="https://public.claycountygov.com/claypay/#cashierid="+n.cashier_id,i.appendChild(t.CreateCellLink("View Receipt","has-text-centered",f))),i},t.CreatePrintablePermitRow=function(n){var i=document.createElement("tr"),r;return i.appendChild(t.CreateCell(n.permit_number.toString())),i.appendChild(t.CreateCell(n.charge_description)),r=n.narrative!==n.charge_description?n.narrative:"",i.appendChild(t.CreateCell(r)),i.appendChild(t.CreateCell(Utilities.Format_Amount(n.amount),"has-text-right")),n.cashier_id.length===0?i.appendChild(t.CreateCell("")):i.appendChild(t.CreateCell(n.cashier_id,"has-text-centered")),i},t.CreateCell=function(n,t){t===void 0&&(t="");var i=document.createElement("td");return t.length>0&&i.classList.add(t),i.appendChild(document.createTextNode(n)),i},t.CreateCellLink=function(n,t,i){var u,r;return t===void 0&&(t=""),i===void 0&&(i=""),u=document.createElement("td"),t.length>0&&u.classList.add(t),r=document.createElement("a"),r.classList.add("has-text-link"),r.target="_blank",r.rel="noopener",r.href=i,r.appendChild(document.createTextNode(n)),r.setAttribute("aria-label","View on Claypay"),u.appendChild(r),u},t.charges_container="chargeContainer",t}();n.Charge=t}(PermitSearch||(PermitSearch={})),function(n){var t=function(){function t(){this.table_number=-1;this.object_id=-1;this.permit_number=-1;this.document_type="";this.page_count=0;this.created_on=new Date}return t.CreateDocumentDownloadLink=function(n,t){return"http://publicrecords.claycountygov.com/GetFile?t="+n.toString()+"&o="+t.toString()},t.QueryDocuments=function(i){t.ResetDocuments();var r=n.GetPath();Utilities.Get(r+"API/Permit/Documents?permitnumber="+i.toString()).then(function(i){console.log("documents",i);n.permit_documents=i;t.ResetDocumentTypeFilter();i.length===0?n.CreateMessageRow(t.documents_container,4,"No documents were found for this permit."):(t.CreateDocumentsTable(i),t.PopulateDocumentTypeFilter(i))},function(i){n.CreateMessageRow(t.documents_container,4,"There was an issue retrieving the documents for this permit.  Please try again.");console.log("error getting permits",i)})},t.ResetDocumentTypeFilter=function(){var i=document.getElementById(t.document_type_filter),n;Utilities.Clear_Element(i);i.disabled=!0;n=document.createElement("option");n.text="Show All";n.value="all";n.selected=!0;i.add(n,0)},t.PopulateDocumentTypeFilter=function(n){var h=document.getElementById(t.document_type_filter),r,u,o,f,s,i,e;for(h.disabled=!1,r=[],u=0,o=n;u<o.length;u++)i=o[u],r.indexOf(i.document_type)===-1&&r.push(i.document_type);for(r.sort(),f=0,s=r;f<s.length;f++)i=s[f],e=document.createElement("option"),e.value=i,e.text=i,h.add(e)},t.FilterDocuments=function(){var i=Utilities.Get_Value("documentTypeFilter"),r;i==="all"?t.CreateDocumentsTable(n.permit_documents):(r=n.permit_documents.filter(function(n){return n.document_type===i}),t.CreateDocumentsTable(r))},t.CreateDocumentsTable=function(n){for(var e,r,u=document.createDocumentFragment(),i=0,f=n;i<f.length;i++)e=f[i],u.appendChild(t.CreateDocumentsRow(e));r=document.getElementById(t.documents_container);Utilities.Clear_Element(r);r.appendChild(u)},t.ResetDocuments=function(){n.permit_documents=[];n.CreateMessageRow(t.documents_container,4,"Loading Documents...")},t.CreateDocumentsRow=function(n){var i=document.createElement("tr"),r=t.CreateDocumentDownloadLink(n.table_number,n.object_id);return i.appendChild(t.CreateDocumentsCellLink("",r)),i.appendChild(t.CreateDocumentsCell(n.document_type)),i.appendChild(t.CreateDocumentsCell(n.page_count.toString(),"has-text-left")),i.appendChild(t.CreateDocumentsCell(Utilities.Format_Date(n.created_on))),i},t.CreateDocumentsCell=function(n,t){t===void 0&&(t="");var i=document.createElement("td");return t.length>0&&i.classList.add(t),i.appendChild(document.createTextNode(n)),i},t.CreateDocumentsCellLink=function(n,t){var u,i,r;return n===void 0&&(n=""),t===void 0&&(t=""),u=document.createElement("td"),n.length>0&&u.classList.add(n),i=document.createElement("a"),r=document.createElement("i"),r.classList.add("show"),r.classList.add("fas"),r.classList.add("fa-download"),r.style.color="#20bc56",i.classList.add("has-text-link"),i.href=t,i.appendChild(r),i.setAttribute("aria-label","Download Document"),i.onclick=function(){Utilities.Clear_Element(i);var n=document.createElement("i");n.classList.add("hide");n.classList.add("fas");n.classList.add("fa-check-circle");n.style.color="#20bc56";i.appendChild(n)},u.appendChild(i),u},t.documents_container="documentContainer",t.document_type_filter="documentTypeFilter",t}();n.Document=t}(PermitSearch||(PermitSearch={})),function(n){"use strict";var t=function(){function t(){}return t.QueryHolds=function(i){t.ResetHolds();var r=n.GetPath();Utilities.Get(r+"API/Permit/Holds?permitnumber="+i.toString()).then(function(i){console.log("holds",i);n.permit_holds=i;i.length===0?n.CreateMessageRow(t.holds_container,1,"No Holds were found for this permit."):t.CreateDocumentsTable(i,t.holds_container)},function(i){n.CreateMessageRow(t.holds_container,1,"There was an issue retrieving the holds for this permit.  Please try again.");console.log("error getting holds",i)})},t.ResetHolds=function(){n.permit_holds=[];n.CreateMessageRow(t.holds_container,1,"Loading Holds...")},t.CreateDocumentsTable=function(n,i){for(var o,u,f=document.createDocumentFragment(),r=0,e=n;r<e.length;r++)o=e[r],f.appendChild(t.CreateRow(o));u=document.getElementById(i);Utilities.Clear_Element(u);u.appendChild(f)},t.CreateRow=function(n){var i=document.createElement("tr");return i.appendChild(t.CreateCell(n.description)),i},t.CreateCell=function(n,t){t===void 0&&(t="");var i=document.createElement("td");return t.length>0&&i.classList.add(t),i.appendChild(document.createTextNode(n)),i},t.holds_container="holdContainer",t}();n.Hold=t}(PermitSearch||(PermitSearch={})),function(n){"use strict";var t=function(){function t(){}return t.QueryPermitNotes=function(i){t.ResetPermitNotes();var r=n.GetPath();Utilities.Get(r+"API/Permit/PermitNotes?permitnumber="+i.toString()).then(function(i){console.log("permit notes",i);n.permit_notes=i;i.length===0?n.CreateMessageRow(t.permit_notes_container,5,"No notes were found for this permit."):t.CreateDocumentsTable(i,t.permit_notes_container)},function(i){n.CreateMessageRow(t.permit_notes_container,5,"There was an issue retrieving the notes for this permit.  Please try again.");console.log("error getting permit notes",i)})},t.ResetPermitNotes=function(){n.permit_notes=[];n.CreateMessageRow(t.permit_notes_container,5,"Loading Notes...")},t.CreateDocumentsTable=function(n,i){for(var o,u,f=document.createDocumentFragment(),r=0,e=n;r<e.length;r++)o=e[r],f.appendChild(t.CreateRow(o));u=document.getElementById(i);Utilities.Clear_Element(u);u.appendChild(f)},t.CreateRow=function(i){var r=document.createElement("tr");return r.appendChild(t.CreateCell(i.permit_number.toString().padStart(8,"0"))),r.appendChild(t.CreateCell(n.stripHtml(i.note))),r.appendChild(t.CreateCell(i.note_type)),new Date(i.created_on.toString()).getFullYear()<1e3?r.appendChild(t.CreateCell("")):r.appendChild(t.CreateCell(Utilities.Format_Date(i.created_on))),r.appendChild(t.CreateCell(i.created_by)),r},t.CreateCell=function(n,t){t===void 0&&(t="");var i=document.createElement("td");return t.length>0&&i.classList.add(t),i.appendChild(document.createTextNode(n)),i},t.permit_notes_container="permitNotesContainer",t}();n.PermitNote=t}(PermitSearch||(PermitSearch={})),function(n){"use strict";var t=function(){function t(){}return t.QueryPlanReview=function(i,r){if(t.ResetPlanReview(),!r){n.CreateMessageRow(t.plans_review_container,7,"No Plans were found for this permit.");return}var u=n.GetPath();Utilities.Get(u+"API/Permit/PlansReview?permitnumber="+i.toString()).then(function(i){console.log("plans reviews",i);n.plan_reviews=i;i.length===0?n.CreateMessageRow(t.plans_review_container,7,"No Plans were found for this permit."):t.CreateTable(i,t.plans_review_container)},function(i){n.CreateMessageRow(t.plans_review_container,7,"There was an issue retrieving the Plans for this permit.  Please try again.");console.log("error getting holds",i)})},t.ResetPlanReview=function(){n.plan_reviews=[];n.CreateMessageRow(t.plans_review_container,7,"Loading Plans...")},t.CreateTable=function(i,r){for(var u,o,f=document.createDocumentFragment(),s=0,e=0,h=i;e<h.length;e++)u=h[e],u.plan_id!=s&&(s=u.plan_id,f.appendChild(t.CreateRow(u)),f.appendChild(t.CreateInitialIssueRow(u))),n.plan_reviews_tbody.appendChild(t.CreateIssueRow(u));o=document.getElementById(r);Utilities.Clear_Element(o);o.appendChild(f)},t.CreateRow=function(i){var r=document.createElement("tr"),f,u;return r.appendChild(t.CreateCell(i.clearance_sheet)),r.appendChild(t.CreateCell(i.plan_type)),r.appendChild(t.CreateCell(Utilities.Format_Date(i.received_date))),r.appendChild(t.CreateCell(i.plan_reviewed_by)),r.appendChild(t.CreateCell(Utilities.Format_Date(i.plan_reviewed_date))),r.appendChild(t.CreateCell(i.review_status)),r.appendChild(t.CreateCell(n.stripHtml(i.comment))),i.issue_id===-1?r.appendChild(t.CreateCell("No Issues")):(f=document.createElement("td"),u=document.createElement("a"),u.onclick=function(){var n=r.nextElementSibling;n.style.display=n.style.display==="none"?"table-row":"none"},u.appendChild(document.createTextNode("View Issues")),f.appendChild(u),r.appendChild(f)),r},t.CreateIssueRow=function(i){var r=document.createElement("tr"),u;return new Date(i.issue_added_on.toString()).getFullYear()<1e3&&i.plan_review_issue.length===0?(u=document.createElement("td"),u.colSpan=7,u.appendChild(document.createTextNode("No Issues have been added.")),r.appendChild(u)):(r.appendChild(t.CreateCell(n.stripHtml(i.plan_review_issue))),r.appendChild(t.CreateCell(Utilities.Format_Date(i.issue_added_on))),r.appendChild(t.CreateCell(i.issue_added_by)),r.appendChild(t.CreateCell(Utilities.Format_Date(i.signed_off_on))),r.appendChild(t.CreateCell(i.signed_off_by))),r},t.CreateInitialIssueRow=function(){var n=document.createElement("tr"),i;return n.style.display="none",n.appendChild(t.CreateCell("")),i=document.createElement("td"),i.colSpan=7,i.appendChild(t.CreateIssueTable()),n.appendChild(i),n},t.CreateIssueTable=function(){var i=document.createElement("table"),r,u;return i.classList.add("table"),i.classList.add("is-fullwidth"),r=document.createElement("thead"),i.appendChild(r),r.appendChild(t.CreateIssueHeaderRow()),u=document.createElement("tbody"),i.appendChild(u),n.plan_reviews_tbody=u,i},t.CreateIssueHeaderRow=function(){var n=document.createElement("tr");return n.appendChild(t.CreateHeaderCell("Issue","40%")),n.appendChild(t.CreateHeaderCell("Added On","15%")),n.appendChild(t.CreateHeaderCell("Added By","15%")),n.appendChild(t.CreateHeaderCell("Signed Off On","15%")),n.appendChild(t.CreateHeaderCell("Signed Off By","15%")),n},t.CreateCell=function(n,t){t===void 0&&(t="");var i=document.createElement("td");return t.length>0&&i.classList.add(t),i.appendChild(document.createTextNode(n)),i},t.CreateHeaderCell=function(n,t,i){i===void 0&&(i="");var r=document.createElement("th");return i.length>0&&r.classList.add(i),r.style.width=t,r.appendChild(document.createTextNode(n)),r},t.plans_review_container="plansReviewContainer",t}();n.PlanReview=t}(PermitSearch||(PermitSearch={})),function(n){var t=function(){function n(n){var r,i,t;if(this.permit_number="",this.permit_display="",this.permit_print="",this.permit_status="all",this.contractor_number="",this.contractor_name="",this.company_name="",this.street_number="",this.street_name="",this.parcel_number="",this.owner_name="",this.page="1",this.tab="",this.sort_on="issuedate",this.sort_direction="D",n.length>0)for(r=n.split("&"),i=0;i<r.length;i++){t=r[i].split("=");switch(t[0].toLowerCase()){case"permitnumber":this.permit_number=t[1];break;case"permitdisplay":this.permit_display=t[1];break;case"permitprint":this.permit_print=t[1];break;case"status":this.permit_status=t[1];break;case"contractorid":this.contractor_number=t[1];break;case"contractorname":this.contractor_name=t[1];break;case"companyname":this.company_name=t[1];break;case"streetnumber":this.street_number=t[1];break;case"streetname":this.street_name=t[1];break;case"owner":this.owner_name=t[1];break;case"parcel":this.parcel_number=t[1];break;case"page":this.page=t[1];break;case"tab":this.tab=t[1];break;case"sortdirection":this.sort_direction=t[1];break;case"sortfield":this.sort_on=t[1]}}else this.ReadInputs()}return n.prototype.UpdateInputs=function(){Utilities.Set_Value("permitStatus",this.permit_status);Utilities.Set_Value("permitSearch",this.permit_number);Utilities.Set_Value("streetNumberSearch",this.street_number);Utilities.Set_Value("streetNameSearch",this.street_name);Utilities.Set_Value("parcelSearch",this.parcel_number);Utilities.Set_Value("ownerSearch",this.owner_name);Utilities.Set_Value("contractorNumberSearch",this.contractor_number);Utilities.Set_Value("contractorNameSearch",this.contractor_name);Utilities.Set_Value("companyNameSearch",this.company_name)},n.prototype.ReadInputs=function(){this.permit_status=Utilities.Get_Value("permitStatus").trim();this.permit_number=Utilities.Get_Value("permitSearch").trim();this.street_number=Utilities.Get_Value("streetNumberSearch").trim();this.street_name=Utilities.Get_Value("streetNameSearch").trim();this.parcel_number=Utilities.Get_Value("parcelSearch").trim();this.owner_name=Utilities.Get_Value("ownerSearch").trim();this.contractor_number=Utilities.Get_Value("contractorNumberSearch").trim();this.contractor_name=Utilities.Get_Value("contractorNameSearch").trim();this.company_name=Utilities.Get_Value("companyNameSearch").trim()},n.prototype.ReadyToSearch=function(){switch(this.tab.toLowerCase()){case"permit":return this.permit_number.length>0;case"address":return this.street_number.length>0||this.street_name.length>0;case"contractor":return this.contractor_number.length>0||this.contractor_name.length>0||this.company_name.length>0;case"owner":return this.owner_name.length>0;case"parcel":return this.parcel_number.length>0}},n.prototype.ToHash=function(){var t="";t+=n.AddToHash(this.tab,"tab");t+=n.AddToHash(this.permit_display,"permitdisplay");t+=n.AddToHash(this.permit_print,"permitprint");t+=n.AddToHash(this.sort_on,"sortfield");t+=n.AddToHash(this.sort_direction,"sortdirection");switch(this.tab.toLowerCase()){case"permit":t+=n.AddToHash(this.permit_number,"permitnumber");break;case"address":t+=n.AddToHash(this.street_number,"streetnumber");t+=n.AddToHash(this.street_name,"streetname");break;case"contractor":t+=n.AddToHash(this.contractor_number,"contractorid");t+=n.AddToHash(this.contractor_name,"contractorname");t+=n.AddToHash(this.company_name,"companyname");break;case"owner":t+=n.AddToHash(this.owner_name,"owner");break;case"parcel":t+=n.AddToHash(this.parcel_number,"parcel")}return t.length===0?"":(t+=n.AddToHash(this.permit_status,"status"),t+=n.AddToHash(this.page,"page"),t.length>0&&(t="#"+t.substring(1)+"&v="+(new Date).getMilliseconds().toString()),t)},n.prototype.ReadyToTogglePermitDisplay=function(n){return n===null||this.permit_print.length>0?!1:this.permit_display.length>0&&n.permit_display.length===0||this.permit_display.length===0&&n.permit_display.length>0?this.permit_number===n.permit_number&&this.company_name===n.company_name&&this.contractor_name===n.contractor_name&&this.contractor_number===n.contractor_number&&this.owner_name===n.owner_name&&this.page===n.page&&this.parcel_number===n.parcel_number&&this.permit_status===n.permit_status&&this.street_name===n.street_name&&this.street_number===n.street_number:!1},n.prototype.ReadyToTogglePermitPrint=function(n){return n===null?!1:this.permit_print.length>0&&n.permit_print.length===0||this.permit_print.length===0&&n.permit_print.length>0?this.permit_number===n.permit_number&&this.company_name===n.company_name&&this.contractor_name===n.contractor_name&&this.contractor_number===n.contractor_number&&this.owner_name===n.owner_name&&this.page===n.page&&this.parcel_number===n.parcel_number&&this.permit_status===n.permit_status&&this.street_name===n.street_name&&this.street_number===n.street_number&&this.permit_display===n.permit_display:!1},n.AddToHash=function(n,t){return n.length>0?"&"+t+"="+n:""},n}();n.LocationHash=t}(PermitSearch||(PermitSearch={})),function(n){"use strict";function it(){Utilities.Build_Menu_Elements("menuTabs",n.Menus);window.onhashchange=h;location.hash.length>1&&h(null);l();setInterval(function(){l()},6e4);rt();ut()}function rt(){var t=document.querySelectorAll("#views > section input"),n,i;if(t.length>0)for(n=0;n<t.length;n++)i=t.item(n),i.onkeydown=function(n){var t=n||window.event;n.keyCode==13&&a()}}function ut(){var t=document.querySelectorAll("#searchButtons button.is-reset"),n,i;if(t.length>0)for(n=0;n<t.length;n++)i=t.item(n),i.onclick=function(){return tt()}}function l(){var t=c();Utilities.Get(t+"API/Timing").then(function(t){n.date_updated=t;var r=document.getElementById("updateTimeContainer"),i=document.getElementById("updateTime");Utilities.Clear_Element(i);i.appendChild(document.createTextNode(new Date(n.date_updated).toLocaleString("en-us")));Utilities.Show(r)},function(n){console.log("error getting date updated",n)})}function a(){o(!0);var t=new n.LocationHash("");t.tab=n.selected_tab;location.hash=t.ToHash()}function ft(){Utilities.Toggle_Loading_Button("PermitPrintButton",!0);var t=new n.LocationHash(location.hash.substring(1));t.permit_print=t.permit_display;t.permit_display="";location.hash=t.ToHash()}function et(t){w(!0);b(!1);var i="Building Permit # "+t.permit_number;new Date(t.void_date).getFullYear()!==1&&(i+=" VOIDED");Utilities.Set_Text("printablePermitTitle",i);Utilities.Set_Text("printablePermitIssueDate",Utilities.Format_Date(t.issue_date));Utilities.Set_Text("printablePermitParcel",t.parcel_number);Utilities.Set_Text("printablePermitProposedUse",t.proposed_use);Utilities.Set_Text("printablePermitValuation",Utilities.Format_Amount(t.valuation));Utilities.Set_Text("printablePermitLegal",t.legal);Utilities.Set_Text("printablePermitProjectAddress",t.project_address);Utilities.Set_Text("printablePermitOwner",t.owner_name);Utilities.Set_Text("printablePermitOwnerAddress",t.owner_address);Utilities.Set_Text("printablePermitContractor1",t.contractor_data_line1);t.contractor_data_line1==="OWNER"?(Utilities.Hide("printablePermitContractor2"),Utilities.Hide("printablePermitContractor3")):(Utilities.Show("printablePermitContractor2"),Utilities.Show("printablePermitContractor3"),Utilities.Set_Text("printablePermitContractor2",t.contractor_data_line2),Utilities.Set_Text("printablePermitContractor3",t.contractor_data_line3));v(t.notes);ot(t.flood_data);t.outstanding_holds.length===0?n.CreateMessageRow("printablePermitHoldContainer",1,"No outstanding holds were found for this permit."):n.Hold.CreateDocumentsTable(t.outstanding_holds,"printablePermitHoldContainer");t.permit_fees.length===0?n.CreateMessageRow("printablePermitFeeContainer",4,"No charges were found for this permit."):n.Charge.CreatePrintableViewTable(t.permit_fees,"printablePermitFeeContainer");p()}function ot(n){var i=document.getElementById("printablePermitFloodData"),r,o,t,c,l;if(Utilities.Clear_Element(i),n.length==0){i.appendChild(f("No Flood data found."));return}var u=0,e=[],s=!1,h=!1;for(r=0,o=n;r<o.length;r++)t=o[r],t.fema_elevation>u&&(u=t.fema_elevation),e.indexOf(t.flood_zone_code)===-1&&e.push(t.flood_zone_code),t.conditional_letter_of_map_revision&&(h=!0),t.special_flood_hazard_area&&(s=!0);i.appendChild(f("First Floor Elevation: "+u.toFixed(2)));i.appendChild(f("Flood Zone: "+e.join(",")));c="Special Flood Hazard Area: "+(s?"Yes":"No");i.appendChild(f(c));l="Conditional Letter of Map Revision: "+(h?"Yes":"No");i.appendChild(f(l))}function f(n){var t=document.createElement("p");return t.classList.add("column"),t.classList.add("is-half"),t.appendChild(document.createTextNode(n)),t}function v(n){var r=document.getElementById("printablePermitInformation"),t,i,u;for(Utilities.Clear_Element(r),t=0,i=n;t<i.length;t++)u=i[t],r.appendChild(f(y(u)))}function y(n){var t=(new DOMParser).parseFromString(n,"text/html");return t.body.textContent||""}function st(t){var i,r,u;w(!1);b(!0);i=t.permit_type_string+" Permit # "+t.permit_number;new Date(t.void_date).getFullYear()!==1&&(i+=" VOIDED");Utilities.Set_Text("printablePermitTitle",i);Utilities.Set_Text("printablePermitIssueDate",Utilities.Format_Date(t.issue_date));Utilities.Set_Text("printablePermitParcel",t.parcel_number);r="N/A";t.proposed_use.trim().length>0&&(r=t.proposed_use.trim());Utilities.Set_Text("printablePermitProposedUse",r);Utilities.Set_Text("printablePermitValuation",Utilities.Format_Amount(t.valuation));u="N/A";t.legal.length>0&&(u=t.legal);Utilities.Set_Text("printablePermitLegal",u);Utilities.Set_Text("printablePermitProjectAddress",t.project_address);Utilities.Set_Text("printablePermitOwner",t.owner_name);Utilities.Set_Text("printablePermitOwnerAddress",t.owner_address);Utilities.Set_Text("printablePermitContractor1",t.contractor_data_line1);Utilities.Set_Text("printablePermitContractor2",t.contractor_data_line2);Utilities.Set_Text("printablePermitContractor3",t.contractor_data_line3);t.master_permit_number.length===0?(Utilities.Set_Text("printablePermitMasterPermitNumber",""),Utilities.Set_Text("printablePermitMasterContractorNumber",""),Utilities.Set_Text("printablePermitMasterContractorName",""),Utilities.Set_Text("printablePermitMasterPermitTitle",""),Utilities.Hide("master-permit-container"),Utilities.Hide("printablePermitMasterPermitTitle")):(Utilities.Show("master-permit-container"),Utilities.Show("printablePermitMasterPermitTitle"),Utilities.Set_Text("printablePermitMasterPermitTitle","Master Permit # "+t.master_permit_number),Utilities.Set_Text("printablePermitMasterPermitNumber",t.master_permit_number),Utilities.Set_Text("printablePermitMasterContractorNumber",t.general_contractor_license_number),Utilities.Set_Text("printablePermitMasterContractorName",t.general_contractor_name));v(t.notes);t.outstanding_holds.length===0?n.CreateMessageRow("printablePermitHoldContainer",1,"No outstanding holds were found for this permit."):n.Hold.CreateDocumentsTable(t.outstanding_holds,"printablePermitHoldContainer");t.permit_fees.length===0?n.CreateMessageRow("printablePermitFeeContainer",4,"No charges were found for this permit."):n.Charge.CreatePrintableViewTable(t.permit_fees,"printablePermitFeeContainer");p()}function p(){var n=document.getElementById("selectedPermitPrint");n.classList.add("is-active");Utilities.Toggle_Loading_Button("PermitPrintButton",!1)}function o(n){var i=document.querySelectorAll("#views > section button"),t,r;if(i.length>0)for(t=0;t<i.length;t++)r=i.item(t),Utilities.Toggle_Loading_Button(r,n)}function w(n){var i=document.querySelectorAll("#printablePermit .master-permit-only"),t;if(i.length>0)for(t=0;t<i.length;t++)n?Utilities.Show(i.item(t)):Utilities.Hide(i.item(t))}function b(n){var i=document.querySelectorAll("#printablePermit .assoc-permit-only"),t;if(i.length>0)for(t=0;t<i.length;t++)n?Utilities.Show(i.item(t)):Utilities.Hide(i.item(t))}function h(t){var f;Utilities.Clear_Element(document.getElementById("permitSearchError"));var r=new n.LocationHash(location.hash.substring(1)),i=new n.LocationHash(location.hash.substring(1)),u=null;if(t!==null?(f=t.oldURL.split("#"),f.length===2&&(u=new n.LocationHash(f[1]))):r.UpdateInputs(),i.ReadyToTogglePermitDisplay(u)){k(i.permit_display);o(!1);return}if(i.ReadyToTogglePermitPrint(u)){d(i.permit_print);return}r.ReadyToSearch()?ht(r):o(!1)}function k(t){var f=document.getElementById("selectedPermitPrint"),i,r,u;if(f.classList.remove("is-active"),i=document.getElementById("selectedPermit"),r=document.getElementById("selectedPermitError"),t.length===0){r.classList.remove("is-active");i.classList.remove("is-active");return}u=n.search_results.filter(function(n){return n.permit_number.toString()===t});u.length>0?(bt(u[0]),i.classList.add("is-active")):(Utilities.Set_Text("permitNumberError",t),r.classList.add("is-active"))}function d(t){var r=document.getElementById("selectedPermitPrint"),i;if(t.length===0){r.classList.remove("is-active");return}i=parseInt(t);i>1e4&&i<2e7||i>89999999&&i<1e8?n.MasterPermit.Get(t.toString()):n.AssociatedPermit.Get(t.toString())}function ht(t){var i=c(),r=t.permit_print,u=t.permit_display,e=t.ToHash(),f="?"+e.substring(1);Utilities.Get(i+"API/Search/Permit"+f).then(function(t){console.log("permits",t);n.search_results=t;n.search_results.length>0?(Utilities.Show("searchResults"),g(n.search_results,"resultsHead","resultsBody",!1),r.length>0?d(r):u.length>0&&k(u)):(console.log("no permits found"),Utilities.Hide("searchResults"),Utilities.Error_Show("permitSearchError","No permits found for this search.",!0));o(!1)},function(n){console.log("error getting permits",n);o(!1)});Utilities.Get(i+"API/Search/Count"+f).then(function(i){n.permit_count=i;at(n.permit_count,parseInt(t.page),20,t);console.log("count",i,new Date)},function(n){console.log("error getting permit count",n)})}function g(t,i,r,u){var s=new n.LocationHash(location.hash.substring(1)),h=document.createDocumentFragment(),f,e,c,o,l;for(ct(s.tab,i,u),f=0,e=t;f<e.length;f++)c=e[f],h.appendChild(lt(c,s,u));o=document.getElementById(r);Utilities.Clear_Element(o);o.appendChild(h);r==="resultsBody"&&(l=document.getElementById("searchResults"),l.scrollIntoView())}function ct(n,i,r){var e=document.createDocumentFragment(),u=document.createElement("tr"),f;u.appendChild(t("Permit","","8.5%",r?"":"permit"));u.appendChild(t("Status","","9%",r?"":"status"));u.appendChild(t("Issued","","7.5%",r?"":"issuedate"));u.appendChild(t("Address","has-text-left","30%",r?"":"address"));switch(n.toLowerCase()){case"contractor":u.appendChild(t("Contractor","","12%",r?"":"contractorname"));u.appendChild(t("Company","","15%",r?"":"company"));u.appendChild(t("Age","has-text-right","8%",r?"":"age"));break;case"owner":u.appendChild(t("Owner Name","","15%",r?"":"owner"));u.appendChild(t("Unpaid Charges","has-text-right","20%",r?"":"charges"));break;case"parcel":u.appendChild(t("Parcel #","","15%",r?"":"parcel"));u.appendChild(t("Unpaid Charges","has-text-right","20%",r?"":"charges"));break;case"permit":case"address":default:u.appendChild(t("Unpaid Charges","has-text-right","20%",r?"":"charges"));u.appendChild(t("Documents","","15%",r?"":"documents"))}u.appendChild(t("Inspections","","10%",""));e.appendChild(u);f=document.getElementById(i);Utilities.Clear_Element(f);f.appendChild(e)}function lt(t,r,u){var o=r.tab,e,f;u?(r=new n.LocationHash(""),r.tab=o,r.permit_number=t.permit_number.toString(),r.permit_display=t.permit_number.toString()):(r.permit_display=t.permit_number.toString(),r.permit_print="");e="https://public.claycountygov.com/inspectionscheduler/#permit="+t.permit_number.toString();f=document.createElement("tr");f.appendChild(nt(t.permit_number.toString().padStart(8,"0"),"",r.ToHash(),u));f.appendChild(i(t.is_closed?"Closed":"Open"));new Date(t.issue_date).getFullYear()!==1?f.appendChild(i(Utilities.Format_Date(t.issue_date))):f.appendChild(i("Not Issued"));f.appendChild(i(t.address,"has-text-left"));switch(r.tab.toLowerCase()){case"contractor":f.appendChild(i(t.contractor_name));f.appendChild(i(t.company_name));f.appendChild(i(t.days_since_last_passed_inspection.toString()));break;case"owner":f.appendChild(i(t.owner_name));f.appendChild(i(Utilities.Format_Amount(t.total_charges-t.paid_charges),"has-text-right"));break;case"parcel":f.appendChild(i(t.parcel_number));f.appendChild(i(Utilities.Format_Amount(t.total_charges-t.paid_charges),"has-text-right"));break;case"permit":case"address":default:f.appendChild(i(Utilities.Format_Amount(t.total_charges-t.paid_charges),"has-text-right"));f.appendChild(i(t.document_count.toString()))}return f.appendChild(nt(t.passed_final_inspection?"Completed":"View","",e,!0)),f}function t(t,i,r,u){var f,e,o,s,h;return i===void 0&&(i=""),f=new n.LocationHash(location.hash.substring(1)),e=document.createElement("th"),e.style.width=r,i.length>0&&e.classList.add(i),u.length>0?(o=document.createElement("a"),f.sort_on=u,f.sort_direction=f.sort_direction=="A"?"D":"A",f.page="1",o.href=f.ToHash(),o.classList.add("has-text-link"),o.appendChild(document.createTextNode(t)),s=document.createElement("span"),s.classList.add("icon"),h=document.createElement("i"),h.classList.add("fas"),h.classList.add("fa-sort"),s.appendChild(h),o.appendChild(s),e.appendChild(o)):e.appendChild(document.createTextNode(t)),e}function i(n,t){t===void 0&&(t="");var i=document.createElement("td");return t.length>0&&i.classList.add(t),i.appendChild(document.createTextNode(n)),i}function nt(n,t,i,r){var f,u;return t===void 0&&(t=""),i===void 0&&(i=""),r===void 0&&(r=!1),f=document.createElement("td"),t.length>0&&f.classList.add(t),u=document.createElement("a"),u.classList.add("has-text-link"),r&&(u.rel="noopener",u.target="_blank"),u.href=i,u.appendChild(document.createTextNode(n)),f.appendChild(u),f}function at(n,t,i,r){var e;r.permit_display="";r.permit_print="";var o=Math.ceil(n/i),u=document.getElementById("resultsPreviousPage"),f=document.getElementById("resultsNextPage");t===1?(u.setAttribute("disabled",""),u.href=""):(u.removeAttribute("disabled"),r.page=(t-1).toString(),u.href=r.ToHash());t===o?(f.href="",f.setAttribute("disabled","")):(f.removeAttribute("disabled"),r.page=(t+1).toString(),f.href=r.ToHash());r.page=t.toString();e=document.getElementById("resultsPaginationList");Utilities.Clear_Element(e);e.appendChild(vt(o,t,r))}function vt(n,t,i){var f=document.createDocumentFragment(),u;if(t<1&&(t=1),t>n&&(t=n),n<8){for(u=1;u<=n;u++)f.appendChild(r(u,u===t,i));return f}if(t===3){for(u=1;u<=4;u++)f.appendChild(r(u,u===t,i));for(f.appendChild(s()),u=n-1;u<=n;u++)f.appendChild(r(u,u===t,i));return f}if(t===n-2){for(u=1;u<=2;u++)f.appendChild(r(u,u===t,i));for(f.appendChild(s()),u=n-3;u<=n;u++)f.appendChild(r(u,u===t,i));return f}if(t<3||t>n-3){for(u=1;u<=3;u++)f.appendChild(r(u,u===t,i));for(f.appendChild(s()),u=n-2;u<=n;u++)f.appendChild(r(u,u===t,i));return f}for(f.appendChild(r(1,!1,i)),f.appendChild(s()),u=t-1;u<=t+1;u++)f.appendChild(r(u,u===t,i));return f.appendChild(s()),f.appendChild(r(n,!1,i)),f}function r(n,t,i){i.page=n.toString();i.permit_display="";i.permit_print="";var u=document.createElement("li"),r=document.createElement("a");return r.classList.add("pagination-link"),r.setAttribute("aria-label","Goto page "+i.page),r.href=i.ToHash(),t&&(r.classList.add("is-current"),r.setAttribute("aria-current","page")),r.appendChild(document.createTextNode(i.page)),u.appendChild(r),u}function s(){var t=document.createElement("li"),n=document.createElement("span");return n.classList.add("pagination-ellipsis"),n.innerHTML="&hellip;",t.appendChild(n),t}function yt(){var t=document.querySelectorAll(".modal"),n,i;if(t.length>0)for(n=0;n<t.length;n++)i=t.item(n),i.classList.remove("is-active")}function pt(){var t=new n.LocationHash(location.hash.substring(1));t.permit_display="";location.hash=t.ToHash()}function wt(){var t=new n.LocationHash(location.hash.substring(1));t.permit_display=t.permit_print;t.permit_print="";location.hash=t.ToHash()}function bt(t){kt(t);dt(t);n.Document.QueryDocuments(t.permit_number);n.Hold.QueryHolds(t.permit_number);n.Charge.QueryCharges(t.permit_number);n.PlanReview.QueryPlanReview(t.permit_number,t.has_plans);n.PermitNote.QueryPermitNotes(t.permit_number);n.Permit.QueryRelatedPermits(t.permit_number)}function kt(n){var t=document.getElementById("permitHeading"),i;Utilities.Clear_Element(t);i=e("PERMIT #",n.permit_number.toString().padStart(8,"0"));i.style.flexGrow="2";t.appendChild(i);n.permit_type.length>0&&t.appendChild(e("PERMIT TYPE",n.permit_type));new Date(n.issue_date).getFullYear()!==1?(t.appendChild(e("ISSUE DATE",Utilities.Format_Date(n.issue_date))),Utilities.Show("PermitPrintButton")):(t.appendChild(e("ISSUE DATE","Not Issued")),Utilities.Hide("PermitPrintButton"));new Date(n.void_date).getFullYear()!==1?t.appendChild(e("VOID DATE",Utilities.Format_Date(n.void_date))):new Date(n.co_date).getFullYear()!==1&&t.appendChild(e("CO DATE",Utilities.Format_Date(n.co_date)))}function dt(n){n.is_closed&&n.close_type.length>0?Utilities.Set_Value("permitCompleted","Yes - "+n.close_type):Utilities.Set_Value("permitCompleted",n.is_closed?"Yes":"No");Utilities.Set_Value("permitFinalInspection",n.passed_final_inspection?"Yes":"No");var t=document.getElementById("permitInspectionSchedulerLink"),i="https://public.claycountygov.com/inspectionscheduler/#permit="+n.permit_number.toString();t.href=i;gt(n);ni(n)}function gt(n){var r=document.getElementById("propertyFieldset"),t=document.createDocumentFragment(),i=document.createElement("legend"),f;i.classList.add("label");i.appendChild(document.createTextNode("Property Information"));t.appendChild(i);n.address.length>0&&t.appendChild(u("Address",n.address));n.owner_name.length>0&&t.appendChild(u("Owner",n.owner_name));n.parcel_number.length>0&&(n.pin_complete.length>0?(f="https://qpublic.schneidercorp.com/Application.aspx?AppID=830&LayerID=15008&PageTypeID=4&KeyValue="+n.pin_complete,t.appendChild(ti("Parcel Number",n.parcel_number,"View on CCPAO",f))):t.appendChild(u("Parcel Number",n.parcel_number)));Utilities.Clear_Element(r);r.appendChild(t)}function ni(n){var f=document.getElementById("contractorFieldset"),t,i,r;Utilities.Clear_Element(f);t=document.createDocumentFragment();i=document.createElement("legend");i.classList.add("label");i.appendChild(document.createTextNode("Contractor Information"));t.appendChild(i);n.contractor_name.length===0&&n.contractor_number.length===0&&n.company_name.length===0?(r=document.createElement("p"),r.appendChild(document.createTextNode("No Contractor Information found.")),t.appendChild(r)):(n.contractor_number.length>0&&(t.appendChild(u("Contractor Number",n.contractor_number)),t.appendChild(u("Days Since Last Passed Inspection",n.days_since_last_passed_inspection.toString()))),n.contractor_name.length>0&&t.appendChild(u("Contractor Name",n.contractor_name)),n.company_name.length>0&&t.appendChild(u("Company Name",n.company_name)));f.appendChild(t)}function u(n,t){var u=document.createElement("div"),r,f,i;return u.classList.add("field"),r=document.createElement("label"),r.classList.add("label"),r.classList.add("is-medium"),r.appendChild(document.createTextNode(n)),u.appendChild(r),f=document.createElement("div"),f.classList.add("control"),i=document.createElement("input"),i.classList.add("input"),i.classList.add("is-medium"),i.readOnly=!0,i.type="text",i.value=t,f.appendChild(i),u.appendChild(f),u}function ti(n,t,i,r){var s=document.createElement("div"),o,e,h,c,f,u;return s.classList.add("field"),o=document.createElement("label"),o.classList.add("label"),o.classList.add("is-medium"),o.appendChild(document.createTextNode(n)),s.appendChild(o),e=document.createElement("div"),e.classList.add("field"),e.classList.add("is-grouped"),h=document.createElement("div"),h.classList.add("control"),c=document.createElement("div"),c.classList.add("control"),f=document.createElement("input"),f.classList.add("input"),f.classList.add("is-medium"),f.readOnly=!0,f.type="text",f.value=t,u=document.createElement("a"),u.classList.add("button"),u.classList.add("is-medium"),u.classList.add("is-primary"),u.href=r,u.target="_blank",u.rel="noopener",u.appendChild(document.createTextNode(i)),h.appendChild(f),c.appendChild(u),e.appendChild(h),e.appendChild(c),s.appendChild(e),s}function e(n,t){var i=document.createElement("div"),r,u,f;return i.classList.add("level-item"),i.classList.add("has-text-centered"),r=document.createElement("div"),u=document.createElement("p"),u.classList.add("heading"),u.appendChild(document.createTextNode(n)),f=document.createElement("p"),f.classList.add("title"),f.appendChild(document.createTextNode(t)),r.appendChild(u),r.appendChild(f),i.appendChild(r),i}function c(){var n="/",t=window.location.pathname.toLowerCase().indexOf("/permitsearch");return t==0&&(n="/permitsearch/"),n}function ii(n,t,i){var f=document.getElementById(n),u,r;Utilities.Clear_Element(f);u=document.createElement("tr");r=document.createElement("td");r.colSpan=t;r.appendChild(document.createTextNode(i));u.appendChild(r);f.appendChild(u)}function tt(){Utilities.Hide(document.getElementById("searchResults"));Utilities.Clear_Element(document.getElementById("resultsbody"));Utilities.Set_Value("permitStatus","all");Utilities.Set_Value("permitSearch","");Utilities.Set_Value("streetNumberSearch","");Utilities.Set_Value("streetNameSearch","");Utilities.Set_Value("parcelSearch","");Utilities.Set_Value("ownerSearch","");Utilities.Set_Value("contractorNumberSearch","");Utilities.Set_Value("contractorNameSearch","");Utilities.Set_Value("companyNameSearch","");location.hash=""}n.permit_count=0;n.search_results=[];n.permit_documents=[];n.permit_holds=[];n.permit_notes=[];n.plan_reviews=[];n.plan_reviews_tbody=null;n.permit_charges=[];n.selected_tab="permit";n.Menus=[{id:"nav-permitSearchOptions",title:"Search by Permit Number",subTitle:"Searching by Permit number will show you all of the information for that specific permit.",icon:"fas fa-file",label:"Permit",selected:!0,autofocusId:"permitSearch"},{id:"nav-addressSearchOptions",title:"Search by Street Address",subTitle:"Search for permits by any combination of Street Number and Street Name.  Partial street names are allowed. ",icon:"fas fa-home",label:"Address",selected:!1,autofocusId:"streetNumberSearch"},{id:"nav-contractorSearchOptions",title:"Search by Contractor",subTitle:"Search for permits by Contractor Name, Company Name, or Contractor ID.  Enter any combination of Name, Number, or Company Name.",icon:"fas fa-users",label:"Contractor",selected:!1,autofocusId:"contractorNumberSearch"},{id:"nav-ownerSearchOptions",title:"Search by Owner Name",subTitle:"Search for permits by Owner Name.  Partial owner names are permitted.",icon:"fas fa-user",label:"Owner",selected:!1,autofocusId:"ownerSearch"},{id:"nav-parcelSearchOptions",title:"Search by Parcel Number",subTitle:"Search for permits by parcel number.",icon:"fas fa-map",label:"Parcel",selected:!1,autofocusId:"parcelSearch"},];n.Start=it;n.Search=a;n.CreatePrintPermitPreview=ft;n.LoadMasterPermit=et;n.stripHtml=y;n.LoadAssocPermit=st;n.HandleHash=h;n.CreateResultsTable=g;n.CloseModals=yt;n.ClosePermitModal=pt;n.ClosePermitPrintModal=wt;n.GetPath=c;n.CreateMessageRow=ii;n.ResetSearch=tt}(PermitSearch||(PermitSearch={}));